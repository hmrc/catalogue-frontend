@*
* Copyright 2021 HM Revenue & Customs
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*@

@import play.api.mvc.Call
@import uk.gov.hmrc.cataloguefrontend.DateHelper._
@import uk.gov.hmrc.cataloguefrontend.connector.RepositoryDisplayDetails
@import uk.gov.hmrc.cataloguefrontend.ViewMessages
@import uk.gov.hmrc.cataloguefrontend.connector.RepoType
@import helper._

@this(viewMessages: ViewMessages)

@(repositories: Seq[RepositoryDisplayDetails],
form: Form[_]
)(implicit messages: Messages, request: Request[_])

@standard_layout(s"Default Branches", "defaultbranch") {
<header>
    <h1>Default Branch Names</h1>
</header>

@if(form.hasErrors) {
<div class="alert alert-danger" role="alert">
    <ul class="list">
        @form.errors.map { error =>
        <li class="alert-danger"> @Messages(error.message, error.args: _*)</li>
        }
    </ul>
</div>
}

<div id="service-list">
    <form action="/" method="get">
        <div class="form-group row">
            <div class="col-xs-1 padding-reset-right">
                <label for="search">Name:</label>
            </div>
            <div class="col col-xs-3">
                <input class="search form-control" id="search" type="text" name="name" value='@form("name").value' autofocus>
            </div>
            <div class="col-xs-1 padding-reset-right">
                <label for="team">Team:</label>
            </div>
            <div class="col col-xs-3">
                <input class="search form-control" id="team" type="text" name="team" value='@form("team-name").value' autofocus>
            </div>
            <div class="col-xs-1 padding-reset-right">
                <label for="branch">Branch:</label>
            </div>
            <div class="col col-xs-3">
                <input class="search form-control" id="branch" type="text" name="branch" value='@form("branch-name").value' autofocus>
            </div>
        </div>
    </form>
    <table class="table table-striped">
        <tr>
            <th class="col-lg-6"><button role="button" class="sort no-border" data-sort="repo-name">Name</button></th>
            <th class="col-lg-6"><button role="button" class="sort no-border" data-sort="team-name">Team</button></th>
            <th class="col-lg-6"><button role="button" class="sort no-border" data-sort="default-branch">Default Branch Name</button></th>
        </tr>
        <tbody class="list">
        @repositories.zipWithIndex.map{case (repo, i) =>
        <tr id="row@i">
            <td class="service-name" id="row@{i}_name">
                <a class="repo-name" href="@uk.gov.hmrc.cataloguefrontend.routes.CatalogueController.repository(repo.name)">@repo.name @if(repo.archived) { (archived) }</a>
            </td>
            <td class="team-name monospaced" id="row@{i}_team">
                Team-name
            </td>
            <td class="default-branch monospaced" id="row@{i}_default-branch">
                @repo.defaultBranch
            </td>
        </tr>
        }
        </tbody>
    </table>
</div>
}

<!-- listjs configuration -->
<script>
    var options = { valueNames: [ 'repo-name', 'team-name', 'default-branch'],
                    searchColumns: ['repo-name', 'team-name', 'default-branch'] };

    var serviceList = new List('service-list', options);
</script>

@repoTypes = @{
("" ,"All") +: RepoType.values.map(v => (v.asString, v.asString)).toList
}
