@*
 * Copyright 2022 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.cataloguefrontend.ViewMessages
@import uk.gov.hmrc.cataloguefrontend.leakdetection.{LeakDetectionLeaksByRule, UnusedExemption}

@this(viewMessages: ViewMessages)

@(repoName: String, branch: String, exemptions: Seq[LeakDetectionLeaksByRule], unusedExemptions: Seq[UnusedExemption])(implicit messages: Messages, request: Request[_])

@standard_layout(s"Leak detection exemptions") {
    <header>
        <h1>Leak Detection Exemptions</h1>
    </header>

    <h2>@repoName - @branch</h2>

    @if(exemptions.isEmpty && unusedExemptions.isEmpty) {
        <div class="alert alert-success">
            There are no exemptions associated to this branch
        </div>
    }

    @if(exemptions.nonEmpty) {
        <div>
            <h3>Exemptions</h3>
            @LeakDetectionLeaks(exemptions, "Exemptions")
        </div>
    }

    @if(unusedExemptions.nonEmpty) {
      <div id="unused-list">
        <h3>Unused Exemptions</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th class="col-xs-4"><button class="sort no-border" data-sort="rule">Rule</button></th>
                    <th class="col-xs-4"><button class="sort no-border" data-sort="filePath">File</button></th>
                    <th class="col-xs-4"><button class="sort no-border" data-sort="text">Text</button></th>
                </tr>
            </thead>
            <tbody class="list">
            @unusedExemptions.map { e =>
                <tr>
                    <td class="rule">@e.ruleId</td>
                    <td class="filePath">@e.filePath</td>
                    <td class="text">@e.text</td>
                </tr>
            }
            </tbody>
        </table>
      </div>
    }

    <script>
            var unusedOptions = {valueNames: ['rule', 'filePath', 'text']};
            unusedList = new List('unused-list', unusedOptions);
    </script>
}